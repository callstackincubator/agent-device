"use strict";(self.rspackChunkagent_device_docs=self.rspackChunkagent_device_docs||[]).push([["628"],{7431(e,s,n){n.r(s),n.d(s,{default:()=>a});var r=n(6259),i=n(5731);function l(e){let s={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.h1,{id:"replay--e2e-testing-experimental",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#replay--e2e-testing-experimental",children:"#"}),"Replay & E2E Testing (Experimental)"]}),"\n",(0,r.jsx)(s.p,{children:"Agents use refs for exploration and authoring. Replay scripts are deterministic runs that can be used for E2E testing."}),"\n",(0,r.jsxs)(s.h2,{id:"core-model",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#core-model",children:"#"}),"Core model"]}),"\n",(0,r.jsx)(s.p,{children:"Two-pass workflow:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Agent pass: discover and interact with refs (",(0,r.jsx)(s.code,{children:"snapshot"})," -> ",(0,r.jsx)(s.code,{children:"click @e.."})," / ",(0,r.jsx)(s.code,{children:"fill @e.."}),")."]}),"\n",(0,r.jsxs)(s.li,{children:["Deterministic pass: run recorded ",(0,r.jsx)(s.code,{children:".ad"})," script with ",(0,r.jsx)(s.code,{children:"replay"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(s.h2,{id:"record-a-replay-script",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#record-a-replay-script",children:"#"}),"Record a replay script"]}),"\n",(0,r.jsx)(s.p,{children:"Enable recording during a session:"}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"bash",children:(0,r.jsxs)(s.code,{children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"agent-device"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" open"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" Settings"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" --platform"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" ios"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" --session"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" e2e"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" --save-script"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"agent-device"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" snapshot"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" -i"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" --session"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" e2e"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"agent-device"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" click"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" @e13"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" --session"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" e2e"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"agent-device"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" close"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" --session"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" e2e"})]})]})})}),"\n",(0,r.jsxs)(s.p,{children:["On ",(0,r.jsx)(s.code,{children:"close"}),", a replay script is written to:"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"text",children:(0,r.jsx)(s.code,{children:(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{children:"~/.agent-device/sessions/<session>-<timestamp>.ad"})})})})}),"\n",(0,r.jsxs)(s.h2,{id:"run-replay",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#run-replay",children:"#"}),"Run replay"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"bash",children:(0,r.jsx)(s.code,{children:(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"agent-device"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" replay"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" ~/.agent-device/sessions/e2e-2026-02-09T12-00-00-000Z.ad"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" --session"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" e2e-run"})]})})})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Replay reads ",(0,r.jsx)(s.code,{children:".ad"})," scripts."]}),"\n"]}),"\n",(0,r.jsxs)(s.h2,{id:"update-stale-selectors-in-replay-scripts",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#update-stale-selectors-in-replay-scripts",children:"#"}),"Update stale selectors in replay scripts"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"bash",children:(0,r.jsx)(s.code,{children:(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"agent-device"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" replay"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" -u"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" ~/.agent-device/sessions/e2e-2026-02-09T12-00-00-000Z.ad"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" --session"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" e2e-run"})]})})})}),"\n",(0,r.jsx)(s.p,{children:"When a replay step fails, update can:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Take a fresh snapshot."}),"\n",(0,r.jsx)(s.li,{children:"Resolve a stable replacement target."}),"\n",(0,r.jsx)(s.li,{children:"Retry the step."}),"\n",(0,r.jsxs)(s.li,{children:["Rewrite the failing line in the same ",(0,r.jsx)(s.code,{children:".ad"})," file."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Current update targets:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"click"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"fill"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"get"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"is"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"wait"})}),"\n"]}),"\n",(0,r.jsxs)(s.h2,{id:"replay--u-beforeafter-examples",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#replay--u-beforeafter-examples",children:"#"}),(0,r.jsx)(s.code,{children:"replay -u"})," before/after examples"]}),"\n",(0,r.jsx)(s.p,{children:"Example 1: stale selector rewritten in place"}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"sh",children:(0,r.jsxs)(s.code,{children:[(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Before"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"click"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "id=\\"old_continue\\" || label=\\"Continue\\""'})]}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# After `replay -u`"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"click"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "id=\\"auth_continue\\" || label=\\"Continue\\""'})]})]})})}),"\n",(0,r.jsx)(s.p,{children:"Example 2: stale ref-based action upgraded to selector form"}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",lang:"sh",children:(0,r.jsxs)(s.code,{children:[(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# Before"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"snapshot"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" -i"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" -c"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" -s"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "Continue"'})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"click"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" @e13"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "Continue"'})]}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# After `replay -u`"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"snapshot"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" -i"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" -c"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" -s"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "Continue"'})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"click"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "id=\\"auth_continue\\" || label=\\"Continue\\""'})]})]})})}),"\n",(0,r.jsxs)(s.p,{children:["Use ",(0,r.jsx)(s.code,{children:"replay -u"})," locally during maintenance, review the rewritten ",(0,r.jsx)(s.code,{children:".ad"})," lines, then commit the updated script."]}),"\n",(0,r.jsxs)(s.h2,{id:"troubleshooting",children:[(0,r.jsx)(s.a,{className:"rp-header-anchor","aria-hidden":"true",href:"#troubleshooting",children:"#"}),"Troubleshooting"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Replay fails after UI/layout changes:\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Run ",(0,r.jsx)(s.code,{children:"replay -u"})," locally and review the rewritten lines."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["Updating cannot resolve a unique target:\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Re-record that flow (",(0,r.jsx)(s.code,{children:"--save-script"}),") from a fresh exploratory pass."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["Replay file parse error:\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Validate quoting in ",(0,r.jsx)(s.code,{children:".ad"})," lines (unclosed quotes are rejected)."]}),"\n"]}),"\n"]}),"\n"]})]})}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}a.__RSPRESS_PAGE_META={},a.__RSPRESS_PAGE_META["docs%2Freplay-e2e.md"]={toc:[{id:"core-model",text:"Core model",depth:2},{id:"record-a-replay-script",text:"Record a replay script",depth:2},{id:"run-replay",text:"Run replay",depth:2},{id:"update-stale-selectors-in-replay-scripts",text:"Update stale selectors in replay scripts",depth:2},{id:"replay--u-beforeafter-examples",text:"`replay -u` before/after examples",depth:2},{id:"troubleshooting",text:"Troubleshooting",depth:2}],title:"Replay & E2E Testing (Experimental)",headingTitle:"Replay & E2E Testing (Experimental)",frontmatter:{title:"Replay & E2E Testing (Experimental)"}}}}]);