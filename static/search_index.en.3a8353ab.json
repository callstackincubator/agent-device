[{"title":"","content":"<NotFoundLayout />\n","routePath":"/404","lang":"en","toc":[],"frontmatter":{"pageType":"custom"},"version":""},{"title":"Commands","content":"This page summarizes the primary command groups.\n\n## Navigation\n\n```bash\nagent-device boot\nagent-device boot --platform ios\nagent-device boot --platform android\nagent-device open [app]\nagent-device close [app]\nagent-device back\nagent-device home\nagent-device app-switcher\n```\n\n- `boot` ensures the selected target is ready without launching an app.\n- `boot` requires either an active session or an explicit device selector.\n- `boot` is mainly needed when starting a new session and `open` fails because no booted simulator/emulator is available.\n- `open [app]` already boots/activates the selected target when needed.\n- `open <url>` deep links are supported on Android; iOS deep-link open is simulator-only.\n\n## Snapshot and inspect\n\n```bash\nagent-device snapshot [-i] [-c] [-d <depth>] [-s <scope>] [--raw] [--backend ax|xctest]\nagent-device get text @e1\nagent-device get attrs @e1\n```\n\n- `--backend xctest` works on iOS simulators and iOS devices.\n- `--backend ax` is simulator-only.\n- agent-device does not automatically switch from XCTest to AX; choose AX explicitly only for diagnostics.\n\n## Interactions\n\n```bash\nagent-device click @e1\nagent-device focus @e2\nagent-device fill @e2 \"text\"          # Clear then type\nagent-device type \"text\"              # Type into focused field without clearing\nagent-device press 300 500\nagent-device press 300 500 --count 12 --interval-ms 45\nagent-device press 300 500 --count 6 --hold-ms 120 --interval-ms 30 --jitter-px 2\nagent-device swipe 540 1500 540 500 120\nagent-device swipe 540 1500 540 500 120 --count 8 --pause-ms 30 --pattern ping-pong\nagent-device long-press 300 500 800\nagent-device scroll down 0.5\nagent-device pinch 2.0          # zoom in 2x (iOS simulator)\nagent-device pinch 0.5 200 400 # zoom out at coordinates (iOS simulator)\n```\n\n`fill` clears then types. `type` does not clear.\nOn Android, `fill` also verifies text and performs one clear-and-retry pass on mismatch.\n`swipe` accepts an optional `durationMs` argument (default `250ms`, range `16..10000`).\nOn iOS, swipe timing uses a safe normalized duration to avoid long-press side effects.\n`pinch` is iOS simulator-only.\n\n## Find (semantic)\n\n```bash\nagent-device find \"Sign In\" click\nagent-device find label \"Email\" fill \"user@example.com\"\nagent-device find role button click\n```\n\n## Replay\n\n```bash\nagent-device replay ./session.ad      # Run deterministic replay from .ad script\nagent-device replay -u ./session.ad   # Update selector drift and rewrite .ad script in place\n```\n\n- `replay` runs deterministic `.ad` scripts.\n- `replay -u` updates stale recorded actions and rewrites the same script.\n\nSee [Replay & E2E (Experimental)]() for recording and CI workflow details.\n\n## App reinstall (fresh state)\n\n```bash\nagent-device reinstall com.example.app ./build/app.apk --platform android\nagent-device reinstall com.example.app ./build/MyApp.app --platform ios\n```\n\n- `reinstall <app> <path>` uninstalls and installs in one command.\n- Supports Android devices/emulators and iOS simulators.\n- Useful for login/logout reset flows and deterministic test setup.\n\n## Settings helpers\n\n```bash\nagent-device settings wifi on\nagent-device settings wifi off\nagent-device settings airplane on\nagent-device settings airplane off\nagent-device settings location on\nagent-device settings location off\n```\n\n- iOS `settings` support is simulator-only.\n- Android `settings` support works on emulators and devices.\n\n## Media and logs\n\n```bash\nagent-device screenshot                 # Auto filename\nagent-device screenshot page.png        # Explicit screenshot path\nagent-device record start               # Start screen recording to auto filename\nagent-device record start session.mp4   # Start recording to explicit path\nagent-device record stop                # Stop active recording\n```\n\n- iOS `record` is simulator-only.\n\n## iOS device prerequisites\n\n- Xcode + `xcrun devicectl` available.\n- Paired physical device with Developer Mode enabled.\n- Use Automatic Signing in Xcode, or pass optional env overrides:\n  - `AGENT_DEVICE_IOS_TEAM_ID`\n  - `AGENT_DEVICE_IOS_SIGNING_IDENTITY` (optional)\n  - `AGENT_DEVICE_IOS_PROVISIONING_PROFILE`\n- If first-run XCTest setup/build is slow, increase daemon request timeout:\n  - `AGENT_DEVICE_DAEMON_TIMEOUT_MS=180000` (or higher)\n","routePath":"/docs/commands","lang":"en","toc":[{"id":"navigation","text":"Navigation","depth":2,"charIndex":50},{"id":"snapshot-and-inspect","text":"Snapshot and inspect","depth":2,"charIndex":709},{"id":"interactions","text":"Interactions","depth":2,"charIndex":1094},{"id":"find-semantic","text":"Find (semantic)","depth":2,"charIndex":2139},{"id":"replay","text":"Replay","depth":2,"charIndex":2298},{"id":"app-reinstall-fresh-state","text":"App reinstall (fresh state)","depth":2,"charIndex":2694},{"id":"settings-helpers","text":"Settings helpers","depth":2,"charIndex":3078},{"id":"media-and-logs","text":"Media and logs","depth":2,"charIndex":3417},{"id":"ios-device-prerequisites","text":"iOS device prerequisites","depth":2,"charIndex":3828}],"frontmatter":{"title":"Commands"},"version":"","description":"This page summarizes the primary command groups."},{"title":"Installation","content":"## Global install\n\n```bash\nnpm install -g agent-device\n```\n\n## Without installing\n\n```bash\nnpx agent-device open Settings --platform ios\n```\n\n## Requirements\n\n- Node.js 22+\n- Xcode for iOS simulator/device automation (`simctl` + `devicectl`)\n- Android SDK / ADB for Android\n\n## iOS physical device prerequisites\n\n- Device is paired and visible in `xcrun devicectl list devices`.\n- Developer Mode enabled on device.\n- Signing configured in Xcode (Automatic Signing recommended), or use:\n- `AGENT_DEVICE_IOS_TEAM_ID`\n- `AGENT_DEVICE_IOS_SIGNING_IDENTITY`\n- `AGENT_DEVICE_IOS_PROVISIONING_PROFILE`\n- If first-run device setup is slow, increase daemon timeout:\n  - `AGENT_DEVICE_DAEMON_TIMEOUT_MS=180000` (or higher)\n","routePath":"/docs/installation","lang":"en","toc":[{"id":"global-install","text":"Global install","depth":2,"charIndex":0},{"id":"without-installing","text":"Without installing","depth":2,"charIndex":60},{"id":"requirements","text":"Requirements","depth":2,"charIndex":142},{"id":"ios-physical-device-prerequisites","text":"iOS physical device prerequisites","depth":2,"charIndex":275}],"frontmatter":{"title":"Installation"},"version":""},{"title":"Introduction","content":"`agent-device` is a CLI for automating iOS simulators + physical devices and Android emulators + devices from agents. It provides:\n\n- Accessibility snapshots for UI understanding\n- Deterministic interactions (tap, type, scroll)\n- Session-aware workflows and replay\n\nIf you know `agent-browser`, this is the mobile-native counterpart for iOS/Android UI automation.\n\n## What it’s good at\n\n- Capturing structured UI state for LLMs\n- Driving common UI actions with refs or semantic selectors\n- Replaying flows for regression checks\n\n## Platform support highlights\n\n- iOS simulator + iOS device core runner commands: `snapshot`, `wait`, `click`, `fill`, `get`, `is`, `find`, `press`, `long-press`, `focus`, `type`, `scroll`, `scrollintoview`, `back`, `home`, `app-switcher`, `open` (app), `close`, `screenshot`, `appstate`.\n- iOS simulator-only: `alert`, `pinch`, `record`, `reinstall`, `apps`, `settings`, and deep-link open (`open <url>`).\n- Android emulator + Android device support remains unchanged.\n\n## Architecture (high level)\n\n1. CLI sends requests to the daemon.\n2. The daemon manages sessions and dispatches to platform drivers.\n3. iOS uses XCTest runner for snapshots and input on simulators and physical devices.\n4. Android uses ADB-based tooling.\n\n## Example\n\n```bash\n# Navigate and get snapshot\nagent-device open Settings --platform ios\nagent-device snapshot -i\n# Output\n# Page: Contacts\n# App: com.apple.MobileAddressBook\n# Snapshot: 44 nodes\n# @e1 [application] \"Contacts\"\n#  @e2 [window]\n#    @e3 [other]\n#  @e4 [other] \"Lists\"\n#    @e5 [navigation-bar] \"Lists\"\n#      @e6 [button] \"Lists\"\n#      @e7 [text] \"Contacts\"\n#    @e8 [other] \"John Doe\"\n\n# Click and fill\nagent-device click @e8\nagent-device snapshot -i\nagent-device fill @e5 \"Doe 2\"\nagent-device close\n```\n","routePath":"/docs/introduction","lang":"en","toc":[{"id":"what-its-good-at","text":"What it’s good at","depth":2,"charIndex":365},{"id":"platform-support-highlights","text":"Platform support highlights","depth":2,"charIndex":529},{"id":"architecture-high-level","text":"Architecture (high level)","depth":2,"charIndex":1001},{"id":"example","text":"Example","depth":2,"charIndex":1257}],"frontmatter":{"title":"Introduction"},"version":"","description":"agent-device is a CLI for automating iOS simulators + physical devices and Android emulators + devices from agents. It provides: Accessibility snapshots for UI understandingDeterministic interactions (tap, type, scroll)Session-aware workflows and replay If you know agent-browser, this is the mobile-native counterpart for iOS/Android UI automation."},{"title":"Quick Start","content":"Every device automation follows this pattern:\n\n```bash\n# 1. Navigate\nagent-device open SampleApp --platform ios # or android\n\n# 2. Snapshot to get element refs\nagent-device snapshot -i\n# Output:\n# @e1 [heading] \"Sample App\"\n# @e2 [button] \"Settings\"\n\n# 3. Interact using refs\nagent-device click @e2\n\n# 4. Re-snapshot before next interactions\nagent-device snapshot -i\n```\n\nBoot target if there is no ready device/simulator:\n\n```bash\nagent-device boot --platform ios # or android\n```\n\n## Common commands\n\n```bash\nagent-device open SampleApp\nagent-device snapshot -i                 # Get interactive elements with refs\nagent-device click @e2                   # Click by ref\nagent-device fill @e3 \"test@example.com\" # Clear then type (Android verifies and retries once if needed)\nagent-device get text @e1                # Get text content\nagent-device screenshot page.png         # Save to specific path\nagent-device close\n```\n\nIf `open` fails because no booted simulator/emulator/device is available, run `boot --platform ios|android` and retry.\n\n## Semantic discovery\n\nUse `find` for human-readable targeting without refs:\n\n```bash\nagent-device find \"Sign In\" click\nagent-device find label \"Email\" fill \"user@example.com\"\nagent-device find role button click\n```\n\n## Replay (experimental)\n\nFor deterministic replay scripts and E2E guidance, see [Replay & E2E (Experimental)]().\n\n## Scrolling\n\nNavigate content that extends beyond the viewport:\n\n```bash\nagent-device scroll down 0.5            # Scroll down half screen\nagent-device scroll up 0.3              # Scroll up 30%\n```\n\n## Settings helpers\n\nToggle device settings directly:\n\n```bash\nagent-device settings wifi on\nagent-device settings airplane on\nagent-device settings location off\n```\n\nNote: iOS `settings` commands are simulator-only.\n\n## JSON output\n\nFor programmatic parsing in scripts:\n\n```bash\nagent-device snapshot --json\nagent-device get text @e1 --json\n```\n\nNote: The default text output is more compact and preferred for AI agents.\n","routePath":"/docs/quick-start","lang":"en","toc":[{"id":"common-commands","text":"Common commands","depth":2,"charIndex":483},{"id":"semantic-discovery","text":"Semantic discovery","depth":2,"charIndex":1047},{"id":"replay-experimental","text":"Replay (experimental)","depth":2,"charIndex":1264},{"id":"scrolling","text":"Scrolling","depth":2,"charIndex":1379},{"id":"settings-helpers","text":"Settings helpers","depth":2,"charIndex":1580},{"id":"json-output","text":"JSON output","depth":2,"charIndex":1798}],"frontmatter":{"title":"Quick Start"},"version":"","description":"Every device automation follows this pattern: Boot target if there is no ready device/simulator:"},{"title":"Replay & E2E Testing (Experimental)","content":"Agents use refs for exploration and authoring. Replay scripts are deterministic runs that can be used for E2E testing.\n\n## Core model\n\nTwo-pass workflow:\n\n1. Agent pass: discover and interact with refs (`snapshot` -> `click @e..` / `fill @e..`).\n2. Deterministic pass: run recorded `.ad` script with `replay`.\n\n## Record a replay script\n\nEnable recording during a session:\n\n```bash\nagent-device open Settings --platform ios --session e2e --save-script\nagent-device snapshot -i --session e2e\nagent-device click @e13 --session e2e\nagent-device close --session e2e\n```\n\nOn `close`, a replay script is written to:\n\n```text\n~/.agent-device/sessions/<session>-<timestamp>.ad\n```\n\n## Run replay\n\n```bash\nagent-device replay ~/.agent-device/sessions/e2e-2026-02-09T12-00-00-000Z.ad --session e2e-run\n```\n\n- Replay reads `.ad` scripts.\n\n## Update stale selectors in replay scripts\n\n```bash\nagent-device replay -u ~/.agent-device/sessions/e2e-2026-02-09T12-00-00-000Z.ad --session e2e-run\n```\n\nWhen a replay step fails, update can:\n\n- Take a fresh snapshot.\n- Resolve a stable replacement target.\n- Retry the step.\n- Rewrite the failing line in the same `.ad` file.\n\nCurrent update targets:\n\n- `click`\n- `fill`\n- `get`\n- `is`\n- `wait`\n\n## `replay -u` before/after examples\n\nExample 1: stale selector rewritten in place\n\n```sh\n# Before\nclick \"id=\\\"old_continue\\\" || label=\\\"Continue\\\"\"\n\n# After `replay -u`\nclick \"id=\\\"auth_continue\\\" || label=\\\"Continue\\\"\"\n```\n\nExample 2: stale ref-based action upgraded to selector form\n\n```sh\n# Before\nsnapshot -i -c -s \"Continue\"\nclick @e13 \"Continue\"\n\n# After `replay -u`\nsnapshot -i -c -s \"Continue\"\nclick \"id=\\\"auth_continue\\\" || label=\\\"Continue\\\"\"\n```\n\nUse `replay -u` locally during maintenance, review the rewritten `.ad` lines, then commit the updated script.\n\n## Troubleshooting\n\n- Replay fails after UI/layout changes:\n  - Run `replay -u` locally and review the rewritten lines.\n- Updating cannot resolve a unique target:\n  - Re-record that flow (`--save-script`) from a fresh exploratory pass.\n- Replay file parse error:\n  - Validate quoting in `.ad` lines (unclosed quotes are rejected).\n","routePath":"/docs/replay-e2e","lang":"en","toc":[{"id":"core-model","text":"Core model","depth":2,"charIndex":120},{"id":"record-a-replay-script","text":"Record a replay script","depth":2,"charIndex":311},{"id":"run-replay","text":"Run replay","depth":2,"charIndex":674},{"id":"update-stale-selectors-in-replay-scripts","text":"Update stale selectors in replay scripts","depth":2,"charIndex":828},{"id":"replay--u-beforeafter-examples","text":"`replay -u` before/after examples","depth":2,"charIndex":1226},{"id":"troubleshooting","text":"Troubleshooting","depth":2,"charIndex":1796}],"frontmatter":{"title":"Replay & E2E Testing (Experimental)"},"version":"","description":"Agents use refs for exploration and authoring. Replay scripts are deterministic runs that can be used for E2E testing."},{"title":"Selectors","content":"Use `find` to locate elements by semantic attributes instead of raw refs.\n\n```bash\nagent-device find \"Settings\" click\nagent-device find text \"Sign In\" click\nagent-device find label \"Email\" fill \"user@example.com\"\nagent-device find value \"Search\" type \"query\"\nagent-device find role button click\nagent-device find id \"com.example:id/login\" click\n```\n\nTips:\n\n- Use `find ... wait <timeoutMs>` to wait for UI to appear.\n- Combine with scoped snapshots using `snapshot -s \"<label>\"` for speed.\n- \\[Android] If a matched node is not hittable, agent-device will click/focus the nearest hittable ancestor.\n","routePath":"/docs/selectors","lang":"en","toc":[],"frontmatter":{"title":"Selectors"},"version":"","description":"Use find to locate elements by semantic attributes instead of raw refs. Tips: Use find ... wait <timeoutMs> to wait for UI to appear.Combine with scoped snapshots using snapshot -s \"<label>\" for speed.[Android] If a matched node is not hittable, agent-device will click/focus the nearest hittable ancestor."},{"title":"Sessions","content":"Sessions keep device state and snapshots consistent across commands.\n\n```bash\nagent-device open Settings --platform ios\nagent-device session list\nagent-device open Contacts          # change app while reusing the default session\nagent-device close\n```\n\nOpen another session independently (for parallel work):\n\n```bash\nagent-device open Contacts --platform ios --session my-session\nagent-device snapshot -i\nagent-device close --session my-session\n```\n\nNotes:\n\n- `open <app>` within an existing session switches the active app and updates the session bundle id.\n- `open <url>` in iOS sessions is simulator-only.\n- Use `--session <name>` to run multiple sessions in parallel.\n\nFor replay scripts and deterministic E2E guidance, see [Replay & E2E (Experimental)]().\n","routePath":"/docs/sessions","lang":"en","toc":[],"frontmatter":{"title":"Sessions"},"version":"","description":"Sessions keep device state and snapshots consistent across commands. Open another session independently (for parallel work): Notes: open <app> within an existing session switches the active app and updates the session bundle id.open <url> in iOS sessions is simulator-only.Use --session <name> to run multiple sessions in parallel. For replay scripts and deterministic E2E guidance, see Replay & E2E (Experimental)."},{"title":"Snapshots","content":"Snapshots provide a structured view of the UI and generate stable refs.\n\n```bash\nagent-device snapshot                    # Full accessibility tree\nagent-device snapshot -i                 # Interactive elements only (recommended)\nagent-device snapshot -c                 # Compact (remove empty elements)\nagent-device snapshot -d 3               # Limit depth to 3 levels\nagent-device snapshot -s \"Contacts\"      # Scope to label/identifier\nagent-device snapshot -i -c -d 5         # Combine options\n```\n\n| Option       | Description               |\n| ------------ | ------------------------- |\n| `-i`         | Interactive-only output   |\n| `-c`         | Compact structural noise  |\n| `-d <depth>` | Limit tree depth          |\n| `-s <scope>` | Scope to label/identifier |\n\nNote: If XCTest returns 0 nodes (foreground app changed), agent-device fails explicitly.\nIt does not automatically switch to AX.\n\n## Example output:\n\n```bash\nagent-device snapshot -i\n# Output:\n# Snapshot: 44 nodes\n# @e1 [application] \"Contacts\"\n#   @e2 [window]\n#     @e3 [other]\n#   @e4 [other] \"Lists\"\n#     @e5 [navigation-bar] \"Lists\"\n#       @e6 [button] \"Lists\"\n#       @e7 [text] \"Contacts\"\n#     @e8 [other] \"John Doe\"\n#       @e9 [other] \"John Doe\"\n```\n\n## Backends (iOS):\n\n- `xctest` (default): full fidelity, fast, no Accessibility permission required; supported on iOS simulators and iOS devices.\n- `ax`: fast accessibility tree, may miss details, requires Accessibility permission; simulator-only.\n","routePath":"/docs/snapshots","lang":"en","toc":[{"id":"example-output","text":"Example output:","depth":2,"charIndex":907},{"id":"backends-ios","text":"Backends (iOS):","depth":2,"charIndex":1240}],"frontmatter":{"title":"Snapshots"},"version":"","description":"Snapshots provide a structured view of the UI and generate stable refs. Note: If XCTest returns 0 nodes (foreground app changed), agent-device fails explicitly.\nIt does not automatically switch to AX."}]